# Story 4.7: Header & Footer Implementation

## Status: Draft

## Assigned To: Grace

## Story

**As a** user,
**I want** header and footer showing system status,
**so that** I know the system is operational and responsive.

## Acceptance Criteria

1. **Header contains:**
   - Brand: ðŸ”· PrismIQ logo + "Dynamic Pricing Copilot" tagline
   - Pipeline Status: Visual progress indicator (Context â†’ ML â†’ Optimize â†’ Price)
   - System Status: [READY] ðŸŸ¢ indicator (or degraded/error states)
   - Tab Navigation: Three main tabs
   - Honeywell Toggle: ðŸ’¡ button for mapping overlay
2. Pipeline status animates during processing
3. **Footer contains:**
   - Current Segment name
   - Model Status: "3/3 Ready"
   - Last Response Time: "2.3s"
4. Footer updates after each recommendation
5. Graceful handling when backend API unavailable

## Tasks / Subtasks

- [ ] Task 1: Create Header component (AC: 1)
  - [ ] Create `frontend/src/components/layout/Header.tsx`
  - [ ] Add brand section with logo
  - [ ] Add pipeline status indicator
  - [ ] Add system status indicator
  - [ ] Add tab navigation
  - [ ] Add Honeywell toggle button

- [ ] Task 2: Create Brand section (AC: 1)
  - [ ] Add ðŸ”· emoji or SVG logo
  - [ ] Add "PrismIQ" title
  - [ ] Add "Dynamic Pricing Copilot" tagline
  - [ ] Style as cohesive brand unit

- [ ] Task 3: Create Pipeline Status (AC: 1, 2)
  - [ ] Create `PipelineStatus.tsx` component
  - [ ] Show stages: Context â†’ ML â†’ Optimize â†’ Price
  - [ ] Highlight current stage during processing
  - [ ] Add animation for active stage
  - [ ] Show completion checkmarks

- [ ] Task 4: Create System Status (AC: 1, 5)
  - [ ] Create `SystemStatus.tsx` component
  - [ ] [READY] ðŸŸ¢ for healthy
  - [ ] [DEGRADED] ðŸŸ¡ for partial availability
  - [ ] [ERROR] ðŸ”´ for unavailable
  - [ ] Poll health endpoint on mount

- [ ] Task 5: Integrate Tab Navigation (AC: 1)
  - [ ] Add tab buttons from Story 4.1
  - [ ] Highlight active tab
  - [ ] Handle navigation

- [ ] Task 6: Add Honeywell Toggle (AC: 1)
  - [ ] Add ðŸ’¡ button
  - [ ] Toggle Honeywell overlay (Story 4.8)
  - [ ] Store toggle state globally

- [ ] Task 7: Create Footer component (AC: 3, 4)
  - [ ] Create `frontend/src/components/layout/Footer.tsx`
  - [ ] Add current segment display
  - [ ] Add model status display
  - [ ] Add response time display

- [ ] Task 8: Create status store
  - [ ] Create `frontend/src/stores/statusStore.ts`
  - [ ] Track pipeline stage
  - [ ] Track system health
  - [ ] Track last response time

- [ ] Task 9: Implement health polling (AC: 5)
  - [ ] Poll `/health` endpoint
  - [ ] Update system status
  - [ ] Handle connection errors gracefully

## Dev Notes

### Component Structure
```
frontend/src/components/layout/
â”œâ”€â”€ Header.tsx              # Main header component
â”œâ”€â”€ Brand.tsx               # Logo and tagline
â”œâ”€â”€ PipelineStatus.tsx      # Processing pipeline indicator
â”œâ”€â”€ SystemStatus.tsx        # Health status indicator
â”œâ”€â”€ TabNavigation.tsx       # Tab buttons (from Story 4.1)
â”œâ”€â”€ HoneywellToggle.tsx     # ðŸ’¡ overlay toggle
â””â”€â”€ Footer.tsx              # Footer with stats
```

### Header Layout
```tsx
// Header.tsx
export function Header() {
  return (
    <header className="h-16 border-b flex items-center justify-between px-4">
      {/* Left: Brand */}
      <Brand />
      
      {/* Center: Pipeline + Tabs */}
      <div className="flex items-center gap-6">
        <PipelineStatus />
        <TabNavigation />
      </div>
      
      {/* Right: Status + Honeywell */}
      <div className="flex items-center gap-4">
        <SystemStatus />
        <HoneywellToggle />
      </div>
    </header>
  );
}
```

### Brand Component
```tsx
// Brand.tsx
export function Brand() {
  return (
    <div className="flex items-center gap-2">
      <span className="text-2xl">ðŸ”·</span>
      <div>
        <h1 className="font-bold text-lg">PrismIQ</h1>
        <p className="text-xs text-muted-foreground">Dynamic Pricing Copilot</p>
      </div>
    </div>
  );
}
```

### Pipeline Status Component
```tsx
// PipelineStatus.tsx
const stages = ['Context', 'ML', 'Optimize', 'Price'];

export function PipelineStatus() {
  const { currentStage, isProcessing } = useStatusStore();
  
  return (
    <div className="flex items-center gap-1">
      {stages.map((stage, i) => (
        <React.Fragment key={stage}>
          <div className={cn(
            "px-2 py-1 text-xs rounded",
            currentStage === i && isProcessing && "bg-primary-100 animate-pulse",
            currentStage > i && "bg-green-100 text-green-700",
            currentStage < i && "bg-gray-100 text-gray-500"
          )}>
            {currentStage > i && 'âœ“'} {stage}
          </div>
          {i < stages.length - 1 && (
            <span className="text-gray-300">â†’</span>
          )}
        </React.Fragment>
      ))}
    </div>
  );
}
```

### System Status Component
```tsx
// SystemStatus.tsx
export function SystemStatus() {
  const { health, lastChecked } = useStatusStore();
  
  const statusConfig = {
    healthy: { label: 'READY', color: 'ðŸŸ¢', bg: 'bg-green-100' },
    degraded: { label: 'DEGRADED', color: 'ðŸŸ¡', bg: 'bg-yellow-100' },
    unhealthy: { label: 'ERROR', color: 'ðŸ”´', bg: 'bg-red-100' },
  };
  
  const config = statusConfig[health];
  
  return (
    <div className={cn("flex items-center gap-1 px-2 py-1 rounded text-sm", config.bg)}>
      <span>{config.color}</span>
      <span className="font-medium">[{config.label}]</span>
    </div>
  );
}
```

### Footer Component
```tsx
// Footer.tsx
export function Footer() {
  const { currentSegment, modelsReady, lastResponseTime } = useStatusStore();
  
  return (
    <footer className="h-10 border-t flex items-center justify-between px-4 text-sm text-muted-foreground">
      <div>
        Segment: <span className="font-medium">{currentSegment || 'None'}</span>
      </div>
      <div>
        Models: <span className="font-medium">{modelsReady}/3 Ready</span>
      </div>
      <div>
        Last Response: <span className="font-medium">{lastResponseTime}s</span>
      </div>
    </footer>
  );
}
```

### Status Store (Zustand)
```typescript
// stores/statusStore.ts
import { create } from 'zustand';

interface StatusState {
  health: 'healthy' | 'degraded' | 'unhealthy';
  currentStage: number; // 0-3 for pipeline stages
  isProcessing: boolean;
  currentSegment: string | null;
  modelsReady: number;
  lastResponseTime: number;
  setHealth: (health: StatusState['health']) => void;
  setProcessing: (stage: number, isProcessing: boolean) => void;
  setSegment: (segment: string) => void;
  setResponseTime: (time: number) => void;
}

export const useStatusStore = create<StatusState>((set) => ({
  health: 'healthy',
  currentStage: -1,
  isProcessing: false,
  currentSegment: null,
  modelsReady: 3,
  lastResponseTime: 0,
  setHealth: (health) => set({ health }),
  setProcessing: (currentStage, isProcessing) => set({ currentStage, isProcessing }),
  setSegment: (currentSegment) => set({ currentSegment }),
  setResponseTime: (lastResponseTime) => set({ lastResponseTime }),
}));
```

### Testing

- Test file: `frontend/tests/unit/layout/Header.test.tsx`
- Test file: `frontend/tests/unit/layout/Footer.test.tsx`
- Test health status display
- Test pipeline animation
- Test footer updates

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-02 | 1.0 | Initial story creation | SM Agent |

## Dev Agent Record

### Agent Model Used
(To be filled by Dev Agent)

### Debug Log References
(To be filled by Dev Agent)

### Completion Notes List
(To be filled by Dev Agent)

### File List
(To be filled by Dev Agent)

## QA Results
(To be filled by QA Agent)

